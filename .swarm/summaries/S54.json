{"id":"S54","summaryText":"[SUMMARY S54] 26.6 KB | code | 577 lines\n<path>C:\\opencode\\RAGAPPv2\\frontend\\src\\pages\\SettingsPage.tsx</path>\n<type>file</type>\n<content>1: import { useState, useEffect } from \"react\";\n2: import { toast } from \"sonner\";\n3: import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nâ†’ Use /swarm retrieve S54 for full content","fullOutput":"<path>C:\\opencode\\RAGAPPv2\\frontend\\src\\pages\\SettingsPage.tsx</path>\n<type>file</type>\n<content>1: import { useState, useEffect } from \"react\";\n2: import { toast } from \"sonner\";\n3: import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\n4: import { Button } from \"@/components/ui/button\";\n5: import { Input } from \"@/components/ui/input\";\n6: import { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\n7: import { Badge } from \"@/components/ui/badge\";\n8: import { Skeleton } from \"@/components/ui/skeleton\";\n9: import { AlertCircle, Loader2 } from \"lucide-react\";\n10: import { getSettings, updateSettings, testConnections, type ConnectionTestResult } from \"@/lib/api\";\n11: import { useSettingsStore } from \"@/stores/useSettingsStore\";\n12: import { ConnectionStatusBadges } from \"@/components/shared/ConnectionStatusBadges\";\n13: import type { HealthStatus } from \"@/types/health\";\n14: import { useHealthCheck } from \"@/hooks/useHealthCheck\";\n15: \n16: // Internal component that renders the settings form\n17: function SettingsPageContent() {\n18:   const {\n19:     settings,\n20:     formData,\n21:     loading,\n22:     saving,\n23:     error,\n24:     errors,\n25:     setSettings,\n26:     initializeForm,\n27:     setLoading,\n28:     setSaving,\n29:     setError,\n30:     updateFormField,\n31:     validateForm,\n32:     hasChanges,\n33:   } = useSettingsStore();\n34: \n35:   const [apiKey, setApiKey] = useState(() => {\n36:     try {\n37:       return localStorage.getItem(\"kv_api_key\") || \"\";\n38:     } catch {\n39:       return \"\";\n40:     }\n41:   });\n42:   const [apiKeySaved, setApiKeySaved] = useState(false);\n43: \n44:   const handleApiKeySave = () => {\n45:     try {\n46:       localStorage.setItem(\"kv_api_key\", apiKey);\n47:       setApiKeySaved(true);\n48:       toast.success(\"API key saved\");\n49:       setTimeout(() => setApiKeySaved(false), 2000);\n50:     } catch (err) {\n51:       toast.error(\"Failed to save API key\");\n52:     }\n53:   };\n54: \n55:   useEffect(() => {\n56:     let mounted = true;\n57:     getSettings()\n58:       .then((data) => {\n59:         if (mounted) {\n60:           setSettings(data);\n61:           initializeForm(data);\n62:         }\n63:       })\n64:       .catch((err) => {\n65:         if (mounted) {\n66:           setError(err instanceof Error ? err.message : \"Failed to load settings\");\n67:           setLoading(false);\n68:         }\n69:       });\n70:     return () => {\n71:       mounted = false;\n72:     };\n73:   }, [setSettings, initializeForm, setError, setLoading]);\n74: \n75:   const handleInputChange = (field: keyof typeof formData, value: string | boolean) => {\n76:     if (typeof value === \"boolean\") {\n77:       updateFormField(field, value);\n78:     } else {\n79:       const numValue = parseFloat(value);\n80:       if (!isNaN(numValue)) {\n81:         updateFormField(field, numValue);\n82:       }\n83:     }\n84:   };\n85: \n86:   const handleSave = async () => {\n87:     if (!validateForm()) {\n88:       return;\n89:     }\n90: \n91:     setSaving(true);\n92:     setError(null);\n93: \n94:     try {\n95:       const updated = await updateSettings({\n96:         chunk_size: formData.chunk_size,\n97:         chunk_overlap: formData.chunk_overlap,\n98:         retrieval_top_k: formData.max_context_chunks,\n99:         max_distance_threshold: formData.rag_relevance_threshold,\n100:         auto_scan_enabled: formData.auto_scan_enabled,\n101:         auto_scan_interval_minutes: formData.auto_scan_interval_minutes,\n102:         retrieval_window: formData.retrieval_window,\n103:         vector_metric: formData.vector_metric,\n104:         embedding_doc_prefix: formData.embedding_doc_prefix,\n105:         embedding_query_prefix: formData.embedding_query_prefix,\n106:         embedding_batch_size: formData.embedding_batch_size,\n107:       });\n108:       setSettings(updated);\n109:       toast.success(\"Settings saved successfully\");\n110:     } catch (err) {\n111:       setError(err instanceof Error ? err.message : \"Failed to save settings\");\n112:       toast.error(err instanceof Error ? err.message : \"Failed to save settings\");\n113:     } finally {\n114:       setSaving(false);\n115:     }\n116:   };\n117: \n118:   return (\n119:     <>\n120:       {loading && (\n121:         <div className=\"space-y-4\">\n122:           <Card>\n123:             <CardHeader>\n124:               <Skeleton className=\"h-6 w-[180px]\" />\n125:               <Skeleton className=\"h-4 w-[250px]\" />\n126:             </CardHeader>\n127:             <CardContent className=\"space-y-6\">\n128:               <div className=\"space-y-2\">\n129:                 <Skeleton className=\"h-4 w-[100px]\" />\n130:                 <Skeleton className=\"h-10 w-full\" />\n131:               </div>\n132:               <div className=\"space-y-2\">\n133:                 <Skeleton className=\"h-4 w-[120px]\" />\n134:                 <Skeleton className=\"h-10 w-full\" />\n135:               </div>\n136:             </CardContent>\n137:           </Card>\n138:           <Card>\n139:             <CardHeader>\n140:               <Skeleton className=\"h-6 w-[150px]\" />\n141:               <Skeleton className=\"h-4 w-[200px]\" />\n142:             </CardHeader>\n143:             <CardContent className=\"space-y-6\">\n144:               <div className=\"space-y-2\">\n145:                 <Skeleton className=\"h-4 w-[80px]\" />\n146:                 <Skeleton className=\"h-10 w-full\" />\n147:               </div>\n148:               <div className=\"space-y-2\">\n149:                 <Skeleton className=\"h-4 w-[100px]\" />\n150:                 <Skeleton className=\"h-10 w-full\" />\n151:               </div>\n152:               <div className=\"space-y-2\">\n153:                 <Skeleton className=\"h-4 w-[140px]\" />\n154:                 <div className=\"flex items-center gap-4\">\n155:                   <Skeleton className=\"h-10 w-24\" />\n156:                   <Skeleton className=\"h-2 flex-1\" />\n157:                 </div>\n158:               </div>\n159:               <div className=\"flex items-center gap-2 pt-4\">\n160:                 <Skeleton className=\"h-4 w-4\" />\n161:                 <Skeleton className=\"h-4 w-[120px]\" />\n162:               </div>\n163:             </CardContent>\n164:           </Card>\n165:         </div>\n166:       )}\n167: \n168:       {error && (\n169:         <Card>\n170:           <CardContent className=\"py-8\">\n171:             <p className=\"text-destructive text-center\">Error: {error}</p>\n172:           </CardContent>\n173:         </Card>\n174:       )}\n175: \n176:       {!loading && !error && (\n177:         <Tabs defaultValue=\"ai\" className=\"w-full\">\n178:           <TabsList className=\"grid w-full max-w-md grid-cols-3\">\n179:             <TabsTrigger value=\"ai\">AI</TabsTrigger>\n180:             <TabsTrigger value=\"advanced\">Advanced</TabsTrigger>\n181:             <TabsTrigger value=\"api-key\">API Key</TabsTrigger>\n182:           </TabsList>\n183: \n184:           <TabsContent value=\"ai\">\n185:             <Card>\n186:               <CardHeader>\n187:                 <CardTitle>AI Configuration</CardTitle>\n188:                 <CardDescription>Configure AI model and behavior (read-only, set via environment variables)</CardDescription>\n189:               </CardHeader>\n190:               <CardContent className=\"space-y-4\">\n191:                 <div className=\"space-y-2\">\n192:                   <label className=\"text-sm font-medium\">Chat Model</label>\n193:                   <Input\n194:                     value={settings?.chat_model || \"Not configured\"}\n195:                     readOnly\n196:                     className=\"bg-muted\"\n197:                   />\n198:                   <p className=\"text-xs text-muted-foreground\">\n199:                     LLM model used for chat responses (set via CHAT_MODEL env var)\n200:                   </p>\n201:                 </div>\n202:                 <div className=\"space-y-2\">\n203:                   <label className=\"text-sm font-medium\">Embedding Model</label>\n204:                   <Input\n205:                     value={settings?.embedding_model || \"Not configured\"}\n206:                     readOnly\n207:                     className=\"bg-muted\"\n208:                   />\n209:                   <p className=\"text-xs text-muted-foreground\">\n210:                     Model used for document embeddings (set via EMBEDDING_MODEL env var)\n211:                   </p>\n212:                 </div>\n213:               </CardContent>\n214:             </Card>\n215:           </TabsContent>\n216: \n217: \n218: \n219:           <TabsContent value=\"advanced\" className=\"space-y-4\">\n220:             <div className=\"rounded-lg border border-amber-200 bg-amber-50 dark:bg-amber-950/20 dark:border-amber-800 p-3 flex items-start gap-2\">\n221:               <AlertCircle className=\"w-4 h-4 text-amber-600 dark:text-amber-400 mt-0.5 shrink-0\" />\n222:               <p className=\"text-sm text-amber-800 dark:text-amber-200\">\n223:                 Note: Settings updates apply to the running session only.\n224:               </p>\n225:             </div>\n226:             <Card>\n227:               <CardHeader>\n228:                 <CardTitle>Advanced Settings</CardTitle>\n229:                 <CardDescription>Configure document processing and RAG parameters</CardDescription>\n230:               </CardHeader>\n231:               <CardContent className=\"space-y-6\">\n232:                 {/* Chunk Size */}\n233:                 <div className=\"space-y-2\">\n234:                   <label className=\"text-sm font-medium\">Chunk Size (characters)</label>\n235:                   <Input\n236:                     type=\"number\"\n237:                     min={1}\n238:                     value={formData.chunk_size}\n239:                     onChange={(e) => handleInputChange(\"chunk_size\", e.target.value)}\n240:                     className={errors.chunk_size ? \"border-destructive\" : \"\"}\n241:                   />\n242:                   {errors.chunk_size && (\n243:                     <p className=\"text-xs text-destructive\">{errors.chunk_size}</p>\n244:                   )}\n245:                   <p className=\"text-xs text-muted-foreground\">\n246:                     Number of characters per document chunk\n247:                   </p>\n248:                 </div>\n249: \n250:                 {/* Chunk Overlap */}\n251:                 <div className=\"space-y-2\">\n252:                   <label className=\"text-sm font-medium\">Chunk Overlap (characters)</label>\n253:                   <Input\n254:                     type=\"number\"\n255:                     min={1}\n256:                     value={formData.chunk_overlap}\n257:                     onChange={(e) => handleInputChange(\"chunk_overlap\", e.target.value)}\n258:                     className={errors.chunk_overlap ? \"border-destructive\" : \"\"}\n259:                   />\n260:                   {errors.chunk_overlap && (\n261:                     <p className=\"text-xs text-destructive\">{errors.chunk_overlap}</p>\n262:                   )}\n263:                   <p className=\"text-xs text-muted-foreground\">\n264:                     Number of overlapping characters between chunks (must be less than chunk size)\n265:                   </p>\n266:                 </div>\n267: \n268:                 {/* Retrieval Top-K */}\n269:                 <div className=\"space-y-2\">\n270:                   <label className=\"text-sm font-medium\">Retrieval Top-K</label>\n271:                   <Input\n272:                     type=\"number\"\n273:                     min={1}\n274:                     value={formData.max_context_chunks}\n275:                     onChange={(e) => handleInputChange(\"max_context_chunks\", e.target.value)}\n276:                     className={errors.max_context_chunks ? \"border-destructive\" : \"\"}\n277:                   />\n278:                   {errors.max_context_chunks && (\n279:                     <p className=\"text-xs text-destructive\">{errors.max_context_chunks}</p>\n280:                   )}\n281:                   <p className=\"text-xs text-muted-foreground\">\n282:                     Maximum number of chunks to retrieve and include in context\n283:                   </p>\n284:                 </div>\n285: \n286:                 {/* Max Distance Threshold */}\n287:                 <div className=\"space-y-2\">\n288:                   <label className=\"text-sm font-medium\">Max Distance Threshold</label>\n289:                   <div className=\"flex items-center gap-4\">\n290:                     <Input\n291:                       type=\"number\"\n292:                       min={0}\n293:                       max={1}\n294:                       step={0.01}\n295:                       value={formData.rag_relevance_threshold}\n296:                       onChange={(e) => handleInputChange(\"rag_relevance_threshold\", e.target.value)}\n297:                       className={`w-24 ${errors.rag_relevance_threshold ? \"border-destructive\" : \"\"}`}\n298:                     />\n299:                     <input\n300:                       type=\"range\"\n301:                       min={0}\n302:                       max={1}\n303:                       step={0.01}\n304:                       value={formData.rag_relevance_threshold}\n305:                       onChange={(e) => handleInputChange(\"rag_relevance_threshold\", e.target.value)}\n306:                       className=\"flex-1\"\n307:                     />\n308:                   </div>\n309:                   {errors.rag_relevance_threshold && (\n310:                     <p className=\"text-xs text-destructive\">{errors.rag_relevance_threshold}</p>\n311:                   )}\n312:                   <p className=\"text-xs text-muted-foreground\">\n313:                     Maximum distance (1-0) for chunks to be included in context (lower = more strict)\n314:                   </p>\n315:                 </div>\n316: \n317:                 {/* Auto Scan Enabled */}\n318:                 <div className=\"space-y-2\">\n319:                   <div className=\"flex items-center gap-2\">\n320:                     <input\n321:                       type=\"checkbox\"\n322:                       id=\"auto_scan_enabled\"\n323:                       checked={formData.auto_scan_enabled}\n324:                       onChange={(e) => handleInputChange(\"auto_scan_enabled\", e.target.checked)}\n325:                       className=\"h-4 w-4 rounded border-gray-300\"\n326:                     />\n327:                     <label htmlFor=\"auto_scan_enabled\" className=\"text-sm font-medium\">\n328:                       Enable Auto Scan\n329:                     </label>\n330:                   </div>\n331:                   <p className=\"text-xs text-muted-foreground\">\n332:                     Automatically scan for new documents at regular intervals\n333:                   </p>\n334:                 </div>\n335: \n336:                 {/* Auto Scan Interval */}\n337:                 {formData.auto_scan_enabled && (\n338:                   <div className=\"space-y-2\">\n339:                     <label className=\"text-sm font-medium\">Auto Scan Interval (minutes)</label>\n340:                     <Input\n341:                       type=\"number\"\n342:                       min={1}\n343:                       value={formData.auto_scan_interval_minutes}\n344:                       onChange={(e) => handleInputChange(\"auto_scan_interval_minutes\", e.target.value)}\n345:                       className={errors.auto_scan_interval_minutes ? \"border-destructive\" : \"\"}\n346:                     />\n347:                     {errors.auto_scan_interval_minutes && (\n348:                       <p className=\"text-xs text-destructive\">{errors.auto_scan_interval_minutes}</p>\n349:                     )}\n350:                     <p className=\"text-xs text-muted-foreground\">\n351:                       How often to scan for new documents (in minutes)\n352:                     </p>\n353:                   </div>\n354:                 )}\n355: \n356:                 {/* Retrieval Window */}\n357:                 <div className=\"space-y-2\">\n358:                   <label className=\"text-sm font-medium\">Retrieval Window</label>\n359:                   <Input\n360:                     type=\"number\"\n361:                     min={0}\n362:                     max={3}\n363:                     value={formData.retrieval_window}\n364:                     onChange={(e) => handleInputChange(\"retrieval_window\", e.target.value)}\n365:                     className={errors.retrieval_window ? \"border-destructive\" : \"\"}\n366:                   />\n367:                   {errors.retrieval_window && (\n368:                     <p className=\"text-xs text-destructive\">{errors.retrieval_window}</p>\n369:                   )}\n370:                   <p className=\"text-xs text-muted-foreground\">\n371:                     Number of adjacent chunks to include (0-3)\n372:                   </p>\n373:                 </div>\n374: \n375:                 {/* Vector Metric */}\n376:                 <div className=\"space-y-2\">\n377:                   <label className=\"text-sm font-medium\">Vector Metric</label>\n378:                   <select\n379:                     value={formData.vector_metric}\n380:                     onChange={(e) => handleInputChange(\"vector_metric\", e.target.value)}\n381:                     className={`w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${errors.vector_metric ? \"border-destructive\" : \"\"}`}\n382:                   >\n383:                     <option value=\"cosine\">Cosine Similarity</option>\n384:                     <option value=\"euclidean\">Euclidean Distance</option>\n385:                     <option value=\"dot_product\">Dot Product</option>\n386:                   </select>\n387:                   {errors.vector_metric && (\n388:                     <p className=\"text-xs text-destructive\">{errors.vector_metric}</p>\n389:                   )}\n390:                   <p className=\"text-xs text-muted-foreground\">\n391:                     Distance metric used for vector similarity search\n392:                   </p>\n393:                 </div>\n394: \n395:                 {/* Embedding Batch Size */}\n396:                 <div className=\"space-y-2\">\n397:                   <label className=\"text-sm font-medium\">Embedding Batch Size</label>\n398:                   <Input\n399:                     type=\"number\"\n400:                     min={64}\n401:                     max={2048}\n402:                     step={64}\n403:                     value={formData.embedding_batch_size}\n404:                     onChange={(e) => handleInputChange(\"embedding_batch_size\", e.target.value)}\n405:                     className={errors.embedding_batch_size ? \"border-destructive\" : \"\"}\n406:                   />\n407:                   {errors.embedding_batch_size && (\n408:                     <p className=\"text-xs text-destructive\">{errors.embedding_batch_size}</p>\n409:                   )}\n410:                   <p className=\"text-xs text-muted-foreground\">\n411:                     Number of chunks to embed per API request. Higher values = better GPU utilization.\n412:                   </p>\n413:                 </div>\n414: \n415:                 {/* Save Button and Status */}\n416:                 <div className=\"flex items-center gap-4 pt-4 border-t\">\n417:                   <Button\n418:                     onClick={handleSave}\n419:                     disabled={saving || !hasChanges()}\n420:                   >\n421:                     {saving && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n422:                     Save Changes\n423:                   </Button>\n424: \n425:                   {hasChanges() && (\n426:                     <span className=\"text-sm text-muted-foreground\">You have unsaved changes</span>\n427:                   )}\n428:                 </div>\n429:               </CardContent>\n430:             </Card>\n431: \n432:             {/* Advanced Embedding Settings */}\n433:             <Card>\n434:               <CardHeader>\n435:                 <CardTitle>Advanced Embedding Settings</CardTitle>\n436:                 <CardDescription>Configure embedding prefixes for different content types</CardDescription>\n437:               </CardHeader>\n438:               <CardContent className=\"space-y-6\">\n439:                 <div className=\"space-y-2\">\n440:                   <label className=\"text-sm font-medium\">Embedding Document Prefix</label>\n441:                   <textarea\n442:                     value={formData.embedding_doc_prefix}\n443:                     onChange={(e) => handleInputChange(\"embedding_doc_prefix\", e.target.value)}\n444:                     className={`w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 min-h-[80px] ${errors.embedding_doc_prefix ? \"border-destructive\" : \"\"}`}\n445:                     placeholder=\"Passage: \"\n446:                   />\n447:                   {errors.embedding_doc_prefix && (\n448:                     <p className=\"text-xs text-destructive\">{errors.embedding_doc_prefix}</p>\n449:                   )}\n450:                   <p className=\"text-xs text-muted-foreground\">\n451:                     Prefix added to document chunks before embedding (default: \"Passage: \")\n452:                   </p>\n453:                 </div>\n454: \n455:                 <div className=\"space-y-2\">\n456:                   <label className=\"text-sm font-medium\">Embedding Query Prefix</label>\n457:                   <textarea\n458:                     value={formData.embedding_query_prefix}\n459:                     onChange={(e) => handleInputChange(\"embedding_query_prefix\", e.target.value)}\n460:                     className={`w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 min-h-[80px] ${errors.embedding_query_prefix ? \"border-destructive\" : \"\"}`}\n461:                     placeholder=\"Query: \"\n462:                   />\n463:                   {errors.embedding_query_prefix && (\n464:                     <p className=\"text-xs text-destructive\">{errors.embedding_query_prefix}</p>\n465:                   )}\n466:                   <p className=\"text-xs text-muted-foreground\">\n467:                     Prefix added to queries before embedding (default: \"Query: \")\n468:                   </p>\n469:                 </div>\n470:               </CardContent>\n471:             </Card>\n472:           </TabsContent>\n473: \n474:           <TabsContent value=\"api-key\">\n475:             <Card>\n476:               <CardHeader>\n477:                 <CardTitle>API Key</CardTitle>\n478:                 <CardDescription>Configure API key for authenticated requests</CardDescription>\n479:               </CardHeader>\n480:               <CardContent className=\"space-y-4\">\n481:                 <div className=\"space-y-2\">\n482:                   <label className=\"text-sm font-medium\">API Key</label>\n483:                   <Input\n484:                     type=\"password\"\n485:                     value={apiKey}\n486:                     onChange={(e) => setApiKey(e.target.value)}\n487:                     placeholder=\"Enter your API key (if configured)\"\n488:                   />\n489:                   <p className=\"text-xs text-muted-foreground\">\n490:                     Optional. Set this if your server requires authentication. The key is stored in your browser's localStorage.\n491:                   </p>\n492:                 </div>\n493:                 <div className=\"flex items-center gap-4\">\n494:                   <Button onClick={handleApiKeySave}>\n495:                     Save API Key\n496:                   </Button>\n497:                   {apiKeySaved && (\n498:                     <span className=\"text-sm text-green-600 dark:text-green-400\">Saved</span>\n499:                   )}\n500:                 </div>\n501:               </CardContent>\n502:             </Card>\n503:           </TabsContent>\n504:         </Tabs>\n505:       )}\n506:     </>\n507:   );\n508: }\n509: \n510: // Wrapper that provides health status and connection test\n511: function SettingsPageWithStatus({ health }: { health: HealthStatus }) {\n512:   const formatLastChecked = (date: Date | null) => {\n513:     if (!date) return \"Not checked\";\n514:     return `Last checked: ${date.toLocaleTimeString()}`;\n515:   };\n516: \n517:   const [connectionResult, setConnectionResult] = useState<ConnectionTestResult | null>(null);\n518:   const [isTestingConnections, setIsTestingConnections] = useState(false);\n519: \n520:   const handleConnectionTest = async () => {\n521:     setIsTestingConnections(true);\n522:     try {\n523:       const result = await testConnections();\n524:       setConnectionResult(result);\n525:       toast.success(\"Connection test completed\");\n526:     } catch (err) {\n527:       const message = err instanceof Error ? err.message : \"Connection test failed\";\n528:       toast.error(message);\n529:       setConnectionResult(null);\n530:     } finally {\n531:       setIsTestingConnections(false);\n532:     }\n533:   };\n534: \n535:   return (\n536:     <div className=\"space-y-6 animate-in fade-in duration-300\">\n537:       <div className=\"flex items-center justify-between\">\n538:         <div>\n539:           <h1 className=\"text-3xl font-bold tracking-tight\">Settings</h1>\n540:           <p className=\"text-muted-foreground mt-1\">Configure your application preferences</p>\n541:         </div>\n542:         <div className=\"flex flex-col items-end gap-1\">\n543:           <ConnectionStatusBadges health={health} />\n544:           <span className=\"text-xs text-muted-foreground\">{formatLastChecked(health.lastChecked)}</span>\n545:           <Button size=\"sm\" variant=\"outline\" onClick={handleConnectionTest} disabled={isTestingConnections}>\n546:             {isTestingConnections ? (\n547:               <Loader2 className=\"w-3 h-3 animate-spin\" />\n548:             ) : (\n549:               \"Test Connections\"\n550:             )}\n551:           </Button>\n552:           {connectionResult && (\n553:             <div className=\"flex gap-2\">\n554:               {Object.entries(connectionResult).map(([service, info]) => (\n555:                 <Badge key={service} variant={info.ok ? \"outline\" : \"destructive\"} className=\"text-xs\">\n556:                   {service}: {info.ok ? \"OK\" : \"Fail\"}\n557:                 </Badge>\n558:               ))}\n559:             </div>\n560:           )}\n561:         </div>\n562:       </div>\n563:       <SettingsPageContent />\n564:     </div>\n565:   );\n566: }\n567: \n568: // Main SettingsPage that checks health\n569: export default function SettingsPage() {\n570:   const health = useHealthCheck();\n571:   return <SettingsPageWithStatus health={health} />;\n572: }\n\n(End of file - total 572 lines)\n</content>","timestamp":1771875504296,"originalBytes":27226}