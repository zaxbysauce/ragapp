{"id":"S781","summaryText":"[SUMMARY S781] 29.0 KB | code | 638 lines\n<path>C:\\opencode\\RAGAPPv2\\frontend\\src\\pages\\DocumentsPage.tsx</path>\n<type>file</type>\n<content>1: import { useState, useEffect, useCallback, useMemo } from \"react\";\n2: import { useDropzone, type FileRejection } from \"react-dropzone\";\n3: import { toast } from \"sonner\";\nâ†’ Use /swarm retrieve S781 for full content","fullOutput":"<path>C:\\opencode\\RAGAPPv2\\frontend\\src\\pages\\DocumentsPage.tsx</path>\n<type>file</type>\n<content>1: import { useState, useEffect, useCallback, useMemo } from \"react\";\n2: import { useDropzone, type FileRejection } from \"react-dropzone\";\n3: import { toast } from \"sonner\";\n4: import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\n5: import { Button } from \"@/components/ui/button\";\n6: import { Input } from \"@/components/ui/input\";\n7: import { Badge } from \"@/components/ui/badge\";\n8: import { Progress } from \"@/components/ui/progress\";\n9: import { Skeleton } from \"@/components/ui/skeleton\";\n10: import { Checkbox } from \"@/components/ui/checkbox\";\n11: import { FileText, Upload, Search, Trash2, ScanLine, AlertCircle, Loader2, X, RotateCcw, Trash } from \"lucide-react\";\n12: import { listDocuments, scanDocuments, deleteDocument, deleteDocuments, deleteAllDocumentsInVault, getDocumentStats, type Document, type DocumentStatsResponse } from \"@/lib/api\";\n13: import { formatFileSize, formatDate } from \"@/lib/formatters\";\n14: import { useDebounce } from \"@/hooks/useDebounce\";\n15: import { useVaultStore } from \"@/stores/useVaultStore\";\n16: import { useUploadStore } from \"@/stores/useUploadStore\";\n17: import { VaultSelector } from \"@/components/vault/VaultSelector\";\n18: import { StatusBadge } from \"@/components/shared/StatusBadge\";\n19: import { DocumentCard } from \"@/components/shared/DocumentCard\";\n20: import { EmptyState } from \"@/components/shared/EmptyState\";\n21: \n22: const MAX_FILE_SIZE = 50 * 1024 * 1024; // 50MB\n23: \n24: export default function DocumentsPage() {\n25:   const [documents, setDocuments] = useState<Document[]>([]);\n26:   const [stats, setStats] = useState<DocumentStatsResponse | null>(null);\n27:   const [loading, setLoading] = useState(true);\n28:   const [searchQuery, setSearchQuery] = useState(\"\");\n29:   const [debouncedSearchQuery, isSearching] = useDebounce(searchQuery, 300);\n30:   const [isScanning, setIsScanning] = useState(false);\n31:   const [rejectedFiles, setRejectedFiles] = useState<string[]>([]);\n32:   const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());\n33:   const [isBulkDeleting, setIsBulkDeleting] = useState(false);\n34:   const [isBulkDeletingAll, setIsBulkDeletingAll] = useState(false);\n35: \n36:   // Global upload store\n37:   const { uploads, addUploads, cancelUpload, removeUpload, clearCompleted, retryUpload } = useUploadStore();\n38:   const { activeVaultId } = useVaultStore();\n39: \n40:   const fetchDocuments = useCallback(async () => {\n41:     try {\n42:       const response = await listDocuments(activeVaultId ?? undefined);\n43:       setDocuments(response.documents);\n44:     } catch (err) {\n45:       console.error(\"Failed to fetch documents:\", err);\n46:       toast.error(err instanceof Error ? err.message : \"Failed to load documents\");\n47:     }\n48:   }, [activeVaultId]);\n49: \n50:   const fetchStats = useCallback(async () => {\n51:     try {\n52:       const response = await getDocumentStats(activeVaultId ?? undefined);\n53:       setStats(response);\n54:     } catch (err) {\n55:       console.error(\"Failed to fetch stats:\", err);\n56:       toast.error(err instanceof Error ? err.message : \"Failed to load document stats\");\n57:     }\n58:   }, [activeVaultId]);\n59: \n60:   useEffect(() => {\n61:     const loadData = async () => {\n62:       setLoading(true);\n63:       await Promise.all([fetchDocuments(), fetchStats()]);\n64:       setLoading(false);\n65:     };\n66:     loadData();\n67:   }, [fetchDocuments, fetchStats]);\n68: \n69:   // Status polling for documents in processing state\n70:   useEffect(() => {\n71:     const hasProcessingDocs = documents.some(\n72:       (doc) => doc.metadata?.status === \"processing\" || doc.metadata?.status === \"pending\"\n73:     );\n74: \n75:     if (!hasProcessingDocs) return;\n76: \n77:     const interval = setInterval(() => {\n78:       fetchDocuments();\n79:       fetchStats();\n80:     }, 5000);\n81: \n82:     return () => clearInterval(interval);\n83:   }, [documents, fetchDocuments, fetchStats]);\n84: \n85:   // Refresh documents when uploads complete\n86:   useEffect(() => {\n87:     const completedCount = uploads.filter((u) => u.status === \"completed\").length;\n88:     if (completedCount > 0) {\n89:       // Refresh after a short delay to allow backend processing\n90:       const timeout = setTimeout(() => {\n91:         fetchDocuments();\n92:         fetchStats();\n93:       }, 1000);\n94:       return () => clearTimeout(timeout);\n95:     }\n96:   }, [uploads, fetchDocuments, fetchStats]);\n97: \n98:   // Bulk selection handlers\n99:   const handleSelectAll = useCallback((checked: boolean | 'indeterminate') => {\n100:     if (checked) {\n101:       const allIds = new Set(documents.map((doc) => String(doc.id)));\n102:       setSelectedIds(allIds);\n103:     } else {\n104:       setSelectedIds(new Set());\n105:     }\n106:   }, [documents]);\n107: \n108:   const handleSelectOne = useCallback((docId: string, checked: boolean) => {\n109:     setSelectedIds(prev => {\n110:       const newSet = new Set(prev);\n111:       if (checked) {\n112:         newSet.add(docId);\n113:       } else {\n114:         newSet.delete(docId);\n115:       }\n116:       return newSet;\n117:     });\n118:   }, []);\n119: \n120:   const handleBulkDelete = useCallback(async () => {\n121:     if (selectedIds.size === 0) return;\n122:     \n123:     const confirmMsg = `Are you sure you want to delete ${selectedIds.size} document${selectedIds.size > 1 ? 's' : ''}?`;\n124:     if (!window.confirm(confirmMsg)) return;\n125: \n126:     setIsBulkDeleting(true);\n127: \n128:     try {\n129:       const result = await deleteDocuments(Array.from(selectedIds));\n130:       if (result.deleted_count > 0) {\n131:         toast.success(`Deleted ${result.deleted_count} document${result.deleted_count > 1 ? 's' : ''}`);\n132:         setDocuments(prev => prev.filter(doc => !selectedIds.has(doc.id)));\n133:         setStats(prev => prev ? { ...prev, total_documents: Math.max(0, (prev.total_documents ?? 0) - result.deleted_count) } : prev);\n134:       }\n135: \n136:       if (result.failed_ids.length > 0) {\n137:         toast.error(`Failed to delete ${result.failed_ids.length} document${result.failed_ids.length > 1 ? 's' : ''}`);\n138:       }\n139: \n140:       setSelectedIds(new Set());\n141:     } catch (err) {\n142:       toast.error(err instanceof Error ? err.message : \"Failed to delete documents\");\n143:     } finally {\n144:       setIsBulkDeleting(false);\n145:     }\n146:   }, [selectedIds]);\n147: \n148:   const handleDeleteAllInVault = useCallback(async () => {\n149:     if (documents.length === 0) return;\n150:     if (!activeVaultId) {\n151:       toast.error(\"No vault selected\");\n152:       return;\n153:     }\n154: \n155:     const confirmMsg = `Are you sure you want to delete ALL documents in this vault? This action cannot be undone.`;\n156:     if (!window.confirm(confirmMsg)) return;\n157: \n158:     setIsBulkDeletingAll(true);\n159: \n160:     try {\n161:       const result = await deleteAllDocumentsInVault(activeVaultId);\n162:       if (result.deleted_count > 0) {\n163:         toast.success(`Deleted ${result.deleted_count} document${result.deleted_count > 1 ? 's' : ''}`);\n164:         setDocuments([]);\n165:         setStats(prev => prev ? { ...prev, total_documents: 0 } : prev);\n166:       }\n167:     } catch (err) {\n168:       toast.error(err instanceof Error ? err.message : \"Failed to delete documents\");\n169:     } finally {\n170:       setIsBulkDeletingAll(false);\n171:     }\n172:   }, [documents.length, activeVaultId]);\n173: \n174:   const onDrop = useCallback((acceptedFiles: File[]) => {\n175:     if (acceptedFiles.length === 0) return;\n176:     \n177:     addUploads(acceptedFiles, activeVaultId ?? undefined);\n178:     setRejectedFiles([]);\n179:     toast.success(`Added ${acceptedFiles.length} file(s) to upload queue`);\n180:   }, [addUploads, activeVaultId]);\n181: \n182:   const onDropRejected = useCallback((rejected: FileRejection[]) => {\n183:     const rejectedNames = rejected.map((r) => `${r.file.name} (${r.errors.map((e) => e.message).join(', ')})`);\n184:     setRejectedFiles(rejectedNames);\n185:     rejectedNames.forEach((name) => {\n186:       toast.error(`File rejected: ${name}`);\n187:     });\n188:   }, []);\n189: \n190:   const { getRootProps, getInputProps, isDragActive } = useDropzone({\n191:     onDrop,\n192:     onDropRejected,\n193:     accept: {\n194:       'application/pdf': ['.pdf'],\n195:       'text/plain': ['.txt'],\n196:       'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx'],\n197:       'application/msword': ['.doc'],\n198:       'text/markdown': ['.md'],\n199:     },\n200:     maxSize: MAX_FILE_SIZE,\n201:   });\n202: \n203:   const handleScan = async () => {\n204:     setIsScanning(true);\n205:     try {\n206:       const result = await scanDocuments(activeVaultId ?? undefined);\n207:       toast.success(`Scan complete: ${result.added} new document(s) added, ${result.scanned} scanned`);\n208:       await Promise.all([fetchDocuments(), fetchStats()]);\n209:     } catch (err) {\n210:       toast.error(err instanceof Error ? err.message : \"Scan failed\");\n211:     } finally {\n212:       setIsScanning(false);\n213:     }\n214:   };\n215: \n216:   const handleDeleteDocument = async (docId: string) => {\n217:     if (!confirm(\"Are you sure you want to delete this document? This will also remove all associated chunks.\")) return;\n218:     try {\n219:       await deleteDocument(docId);\n220:       toast.success(\"Document deleted successfully\");\n221:       await Promise.all([fetchDocuments(), fetchStats()]);\n222:     } catch (err) {\n223:       toast.error(err instanceof Error ? err.message : \"Failed to delete document\");\n224:     }\n225:   };\n226: \n227:   const filteredDocuments = useMemo(\n228:     () => documents.filter((doc) =>\n229:       doc.filename.toLowerCase().includes(debouncedSearchQuery.toLowerCase())\n230:     ),\n231:     [documents, debouncedSearchQuery]\n232:   );\n233: \n234:   return (\n235:     <div className=\"space-y-6 animate-in fade-in duration-300\">\n236:       <div className=\"flex items-center justify-between\">\n237:         <div>\n238:           <h1 className=\"text-3xl font-bold tracking-tight\">Documents</h1>\n239:           <p className=\"text-muted-foreground mt-1\">Manage your knowledge base documents</p>\n240:         </div>\n241:         <div className=\"flex items-center gap-2\">\n242:           <VaultSelector />\n243:           <Button onClick={handleScan} disabled={isScanning}>\n244:             {isScanning ? (\n245:               <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n246:             ) : (\n247:               <ScanLine className=\"w-4 h-4 mr-2\" />\n248:             )}\n249:             Scan Directory\n250:           </Button>\n251:           {filteredDocuments.length > 0 && (\n252:             <Button \n253:               variant=\"destructive\" \n254:               onClick={handleDeleteAllInVault} \n255:               disabled={isBulkDeletingAll}\n256:             >\n257:               {isBulkDeletingAll ? (\n258:                 <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n259:               ) : (\n260:                 <Trash className=\"w-4 h-4 mr-2\" />\n261:               )}\n262:               Delete All in Vault\n263:             </Button>\n264:           )}\n265:         </div>\n266:       </div>\n267: \n268:       {stats && (\n269:         <div className=\"grid gap-4 md:grid-cols-4\">\n270:           <Card>\n271:             <CardHeader className=\"pb-2\">\n272:               <CardDescription>Total Documents</CardDescription>\n273:               <CardTitle className=\"text-3xl\">{stats.total_documents}</CardTitle>\n274:             </CardHeader>\n275:           </Card>\n276:           <Card>\n277:             <CardHeader className=\"pb-2\">\n278:               <CardDescription>Total Chunks</CardDescription>\n279:               <CardTitle className=\"text-3xl\">{stats.total_chunks}</CardTitle>\n280:             </CardHeader>\n281:           </Card>\n282:           <Card>\n283:             <CardHeader className=\"pb-2\">\n284:               <CardDescription>Total Size</CardDescription>\n285:               <CardTitle className=\"text-3xl\">{formatFileSize(stats.total_size_bytes)}</CardTitle>\n286:             </CardHeader>\n287:           </Card>\n288:           <Card>\n289:             <CardHeader className=\"pb-2\">\n290:               <CardDescription>Processed</CardDescription>\n291:               <CardTitle className=\"text-3xl\">{stats.documents_by_status?.processed || 0}</CardTitle>\n292:             </CardHeader>\n293:           </Card>\n294:         </div>\n295:       )}\n296: \n297:       <Card\n298:         {...getRootProps()}\n299:         className={`border-2 border-dashed cursor-pointer transition-colors ${\n300:           isDragActive ? \"border-primary bg-primary/5\" : \"border-border\"\n301:         }`}\n302:       >\n303:         <input {...getInputProps()} />\n304:         <CardContent className=\"py-8\">\n305:           <div className=\"flex flex-col items-center justify-center text-center\">\n306:             <Upload className=\"w-12 h-12 text-muted-foreground mb-4\" />\n307:             <p className=\"text-lg font-medium\">\n308:               {isDragActive ? \"Drop files here...\" : \"Drag & drop files here, or click to select\"}\n309:             </p>\n310:             <p className=\"text-sm text-muted-foreground mt-1\">\n311:               Supports PDF, DOCX, TXT, MD files (max 50MB each). Uploads continue in background.\n312:             </p>\n313:           </div>\n314:         </CardContent>\n315:       </Card>\n316: \n317:       {/* Upload Queue */}\n318:       {uploads.length > 0 && (\n319:         <Card>\n320:           <CardHeader className=\"flex flex-row items-center justify-between\">\n321:             <div>\n322:               <CardTitle className=\"text-sm\">Upload Queue</CardTitle>\n323:               <CardDescription>\n324:                 {uploads.filter((u) => u.status === \"pending\").length} pending,{\" \"}\n325:                 {uploads.filter((u) => u.status === \"uploading\").length} uploading,{\" \"}\n326:                 {uploads.filter((u) => u.status === \"completed\").length} completed\n327:               </CardDescription>\n328:             </div>\n329:             {uploads.some((u) => u.status === \"completed\" || u.status === \"error\" || u.status === \"cancelled\") && (\n330:               <Button variant=\"ghost\" size=\"sm\" onClick={clearCompleted}>\n331:                 Clear Completed\n332:               </Button>\n333:             )}\n334:           </CardHeader>\n335:           <CardContent className=\"space-y-3\">\n336:             {uploads.map((upload) => (\n337:               <div key={upload.id} className=\"space-y-2\">\n338:                 <div className=\"flex justify-between items-center text-sm\">\n339:                   <span className=\"truncate max-w-[250px]\" title={upload.file.name}>\n340:                     {upload.file.name}\n341:                   </span>\n342:                   <div className=\"flex items-center gap-2\">\n343:                     {upload.status === \"completed\" && (\n344:                       <span className=\"text-green-500 text-xs\">Done</span>\n345:                     )}\n346:                     {upload.status === \"error\" && (\n347:                       <span className=\"text-destructive text-xs\" title={upload.error}>\n348:                         Error\n349:                       </span>\n350:                     )}\n351:                     {upload.status === \"cancelled\" && (\n352:                       <span className=\"text-muted-foreground text-xs\">Cancelled</span>\n353:                     )}\n354:                     {upload.status === \"pending\" && (\n355:                       <span className=\"text-muted-foreground text-xs\">Pending</span>\n356:                     )}\n357:                     {upload.status === \"uploading\" && (\n358:                       <span className=\"text-muted-foreground text-xs\">\n359:                         {upload.progress > 0 ? `${upload.progress}%` : \"Uploading...\"}\n360:                       </span>\n361:                     )}\n362:                     \n363:                     {upload.status === \"pending\" && (\n364:                       <Button\n365:                         variant=\"ghost\"\n366:                         size=\"icon\"\n367:                         className=\"h-7 w-7\"\n368:                         onClick={() => cancelUpload(upload.id)}\n369:                         aria-label={`Cancel upload for ${upload.file.name}`}\n370:                       >\n371:                         <X className=\"w-3 h-3\" />\n372:                       </Button>\n373:                     )}\n374:                     {upload.status === \"error\" && (\n375:                       <Button\n376:                         variant=\"ghost\"\n377:                         size=\"icon\"\n378:                         className=\"h-7 w-7\"\n379:                         onClick={() => retryUpload(upload.id)}\n380:                         aria-label={`Retry upload for ${upload.file.name}`}\n381:                       >\n382:                         <RotateCcw className=\"w-3 h-3\" />\n383:                       </Button>\n384:                     )}\n385:                     {(upload.status === \"completed\" || upload.status === \"cancelled\" || upload.status === \"error\") && (\n386:                       <Button\n387:                         variant=\"ghost\"\n388:                         size=\"icon\"\n389:                         className=\"h-7 w-7\"\n390:                         onClick={() => removeUpload(upload.id)}\n391:                         aria-label={`Remove ${upload.file.name} from queue`}\n392:                       >\n393:                         <X className=\"w-3 h-3\" />\n394:                       </Button>\n395:                     )}\n396:                   </div>\n397:                 </div>\n398:                 {upload.status === \"uploading\" && (\n399:                   <Progress value={upload.progress} className=\"h-1.5\" />\n400:                 )}\n401:               </div>\n402:             ))}\n403:           </CardContent>\n404:         </Card>\n405:       )}\n406: \n407:       {rejectedFiles.length > 0 && (\n408:         <div className=\"p-4 bg-amber-500/10 text-amber-700 rounded-lg\">\n409:           <div className=\"flex items-center gap-2 mb-2\">\n410:             <AlertCircle className=\"w-5 h-5\" />\n411:             <span className=\"font-medium\">Some files were rejected:</span>\n412:           </div>\n413:           <ul className=\"list-disc pl-5 space-y-1\">\n414:             {rejectedFiles.map((file, index) => (\n415:               <li key={index} className=\"text-sm\">{file}</li>\n416:             ))}\n417:           </ul>\n418:         </div>\n419:       )}\n420: \n421:       <div className=\"flex items-center gap-4\">\n422:         <div className=\"relative flex-1 max-w-md\">\n423:           <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n424:           <Input\n425:             placeholder=\"Search documents...\"\n426:             className=\"pl-10\"\n427:             value={searchQuery}\n428:             onChange={(e) => setSearchQuery(e.target.value)}\n429:           />\n430:           {isSearching && (\n431:             <Loader2 className=\"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground animate-spin\" />\n432:           )}\n433:         </div>\n434:         <div className=\"flex items-center gap-2\">\n435:           {selectedIds.size > 0 && (\n436:             <>\n437:               <Badge variant=\"outline\">{selectedIds.size} selected</Badge>\n438:               <Button \n439:                 variant=\"destructive\" \n440:                 size=\"sm\"\n441:                 onClick={handleBulkDelete}\n442:                 disabled={isBulkDeleting}\n443:               >\n444:                 {isBulkDeleting ? (\n445:                   <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n446:                 ) : (\n447:                   <Trash2 className=\"w-4 h-4 mr-2\" />\n448:                 )}\n449:                 Delete Selected\n450:               </Button>\n451:             </>\n452:           )}\n453:           <Badge variant=\"secondary\">{filteredDocuments.length} documents</Badge>\n454:         </div>\n455:       </div>\n456: \n457:       {loading ? (\n458:         <>\n459:           {/* Desktop Table Skeleton (hidden on mobile) */}\n460:           <Card className=\"hidden sm:block\">\n461:             <CardContent className=\"p-0\">\n462:               <div className=\"overflow-x-auto\">\n463:               <table className=\"w-full\">\n464:                 <caption className=\"sr-only\">Documents List</caption>\n465:                 <thead>\n466:                   <tr className=\"border-b bg-muted/50\">\n467:                     <th scope=\"col\" className=\"text-left p-4 font-medium\">\n468:                       <Checkbox disabled aria-label=\"Select all documents\" />\n469:                     </th>\n470:                     <th scope=\"col\" className=\"text-left p-4 font-medium\">Filename</th>\n471:                     <th scope=\"col\" className=\"text-left p-4 font-medium\">Status</th>\n472:                     <th scope=\"col\" className=\"text-left p-4 font-medium\">Chunks</th>\n473:                     <th scope=\"col\" className=\"text-left p-4 font-medium\">Size</th>\n474:                     <th scope=\"col\" className=\"text-left p-4 font-medium\">Uploaded</th>\n475:                     <th scope=\"col\" className=\"text-right p-4 font-medium\">Actions</th>\n476:                   </tr>\n477:                 </thead>\n478:                 <tbody>\n479:                   {[...Array(5)].map((_, i) => (\n480:                     <tr key={i} className=\"border-b\">\n481:                       <td className=\"p-4\">\n482:                         <Checkbox disabled />\n483:                       </td>\n484:                       <td className=\"p-4\">\n485:                         <div className=\"flex items-center gap-2\">\n486:                           <Skeleton className=\"h-4 w-4\" />\n487:                           <Skeleton className=\"h-4 w-[180px]\" />\n488:                         </div>\n489:                       </td>\n490:                       <td className=\"p-4\"><Skeleton className=\"h-5 w-[80px]\" /></td>\n491:                       <td className=\"p-4\"><Skeleton className=\"h-4 w-[40px]\" /></td>\n492:                       <td className=\"p-4\"><Skeleton className=\"h-4 w-[60px]\" /></td>\n493:                       <td className=\"p-4\"><Skeleton className=\"h-4 w-[80px]\" /></td>\n494:                       <td className=\"p-4 text-right\"><Skeleton className=\"h-11 w-11 ml-auto\" /></td>\n495:                     </tr>\n496:                   ))}\n497:                 </tbody>\n498:               </table>\n499:               </div>\n500:             </CardContent>\n501:           </Card>\n502: \n503:           {/* Mobile Cards Skeleton (hidden on desktop) */}\n504:           <div className=\"grid grid-cols-1 gap-3 sm:hidden\">\n505:             {[...Array(3)].map((_, i) => (\n506:               <Card key={i} className=\"w-full\">\n507:                 <CardContent className=\"p-4\">\n508:                   <div className=\"flex items-start justify-between gap-3 mb-3\">\n509:                     <div className=\"flex items-center gap-3 min-w-0 flex-1\">\n510:                       <Skeleton className=\"h-11 w-11 rounded-md\" />\n511:                       <div className=\"min-w-0\">\n512:                         <Skeleton className=\"h-5 w-32 mb-1\" />\n513:                         <Skeleton className=\"h-4 w-24\" />\n514:                       </div>\n515:                     </div>\n516:                     <Skeleton className=\"h-11 w-11 rounded-full\" />\n517:                   </div>\n518:                   <div className=\"grid grid-cols-2 gap-3 text-sm\">\n519:                     <div className=\"space-y-1\">\n520:                       <Skeleton className=\"h-4 w-16\" />\n521:                       <Skeleton className=\"h-6 w-20\" />\n522:                     </div>\n523:                     <div className=\"space-y-1\">\n524:                       <Skeleton className=\"h-4 w-16\" />\n525:                       <Skeleton className=\"h-4 w-16\" />\n526:                     </div>\n527:                     <div className=\"space-y-1\">\n528:                       <Skeleton className=\"h-4 w-16\" />\n529:                       <Skeleton className=\"h-4 w-20\" />\n530:                     </div>\n531:                     <div className=\"space-y-1\">\n532:                       <Skeleton className=\"h-4 w-16\" />\n533:                       <Skeleton className=\"h-4 w-12\" />\n534:                     </div>\n535:                   </div>\n536:                   <div className=\"mt-4 flex sm:hidden\">\n537:                     <Skeleton className=\"h-11 w-full rounded-md\" />\n538:                   </div>\n539:                 </CardContent>\n540:               </Card>\n541:             ))}\n542:           </div>\n543:         </>\n544:       ) : filteredDocuments.length === 0 ? (\n545:         <EmptyState\n546:           icon={FileText}\n547:           title={searchQuery ? \"No documents match your search\" : \"No documents yet\"}\n548:           description={searchQuery ? undefined : \"Upload some files to get started.\"}\n549:         />\n550:       ) : (\n551:         <>\n552:           {/* Desktop Table View (hidden on mobile) */}\n553:           <Card className=\"hidden sm:block\">\n554:             <CardContent className=\"p-0\">\n555:               <div className=\"overflow-x-auto\">\n556:                 <table className=\"w-full\">\n557:                   <caption className=\"sr-only\">Documents List</caption>\n558:                   <thead>\n559:                     <tr className=\"border-b bg-muted/50\">\n560:                       <th scope=\"col\" className=\"text-left p-4 font-medium\">\n561:                         <Checkbox \n562:                           checked={selectedIds.size > 0 && selectedIds.size === filteredDocuments.length}\n563:                           onCheckedChange={handleSelectAll}\n564:                           aria-label=\"Select all documents\"\n565:                         />\n566:                       </th>\n567:                       <th scope=\"col\" className=\"text-left p-4 font-medium\">Filename</th>\n568:                       <th scope=\"col\" className=\"text-left p-4 font-medium\">Status</th>\n569:                       <th scope=\"col\" className=\"text-left p-4 font-medium\">Chunks</th>\n570:                       <th scope=\"col\" className=\"text-left p-4 font-medium\">Size</th>\n571:                       <th scope=\"col\" className=\"text-left p-4 font-medium\">Uploaded</th>\n572:                       <th scope=\"col\" className=\"text-right p-4 font-medium\">Actions</th>\n573:                     </tr>\n574:                   </thead>\n575:                   <tbody>\n576:                     {filteredDocuments.map((doc) => {\n577:                       const docId = String(doc.id);\n578:                       const isSelected = selectedIds.has(docId);\n579:                       return (\n580:                         <tr key={doc.id} className={`border-b hover:bg-muted/50 ${isSelected ? 'bg-muted/30' : ''}`}>\n581:                           <td className=\"p-4\">\n582:                             <Checkbox \n583:                               checked={isSelected}\n584:                               onCheckedChange={(checked) => handleSelectOne(String(doc.id), !!checked)}\n585:                               aria-label={`Select ${doc.filename}`}\n586:                             />\n587:                           </td>\n588:                           <td className=\"p-4\">\n589:                             <div className=\"flex items-center gap-2\">\n590:                               <FileText className=\"w-4 h-4 text-muted-foreground\" />\n591:                               <span className=\"font-medium truncate max-w-[200px]\">{doc.filename}</span>\n592:                             </div>\n593:                           </td>\n594:                           <td className=\"p-4\"><StatusBadge status={doc.metadata?.status as string} /></td>\n595:                           <td className=\"p-4\">{String(doc.metadata?.chunk_count ?? 0)}</td>\n596:                           <td className=\"p-4\">{formatFileSize(doc.size)}</td>\n597:                           <td className=\"p-4 text-muted-foreground\">{formatDate(doc.created_at)}</td>\n598:                           <td className=\"p-4 text-right\">\n599:                             <Button \n600:                               variant=\"ghost\" \n601:                               size=\"icon\" \n602:                               className=\"min-w-[44px] min-h-[44px]\" \n603:                               onClick={() => handleDeleteDocument(String(doc.id))}\n604:                             >\n605:                               <Trash2 className=\"w-4 h-4 text-destructive\" />\n606:                             </Button>\n607:                           </td>\n608:                         </tr>\n609:                       );\n610:                     })}\n611:                   </tbody>\n612:                 </table>\n613:               </div>\n614:             </CardContent>\n615:           </Card>\n616: \n617:            {/* Mobile Cards View (hidden on desktop) */}\n618:            <div className=\"grid grid-cols-1 gap-3 sm:hidden\">\n619:              {filteredDocuments.map((doc) => (\n620:                <DocumentCard\n621:                  key={doc.id}\n622:                  document={doc}\n623:                  onDelete={(id) => handleDeleteDocument(String(id))}\n624:                  isSelected={selectedIds.has(doc.id)}\n625:                  onSelectionChange={handleSelectOne}\n626:                />\n627:              ))}\n628:            </div>\n629:         </>\n630:       )}\n631:     </div>\n632:   );\n633: }\n\n(End of file - total 633 lines)\n</content>","timestamp":1771947284433,"originalBytes":29659}